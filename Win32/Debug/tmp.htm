<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
  <link rel="stylesheet" href="images/style.css" />
</head>

<body class="stackedit"><div class="stackedit__html">

<article class="baidu_pl">
                <div id="article_content" class="article_content clearfix">
                                                <div class="article-copyright">
                <span class="creativecommons">
                <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
                    </a>
            <span>版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。 </span>
               <div class="article-source-link2222">
                    本文链接：<a href="https://blog.csdn.net/byc6352/article/details/100127086">https://blog.csdn.net/byc6352/article/details/100127086</a>
                </div>
            </span>
                    </div>
                                                    <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
                                        <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
                <div class="htmledit_views" id="content_views">
                                            <h1><a name="t0"></a>delphi 详解Variant 的相关函数</h1>

<p>1.VarArrayCreate()和VarArrayOf()这两个常用就不说了<br>
2.VarArrayRedim()函数能修改variant数组的最高限。<br>
3.VarArrayDimCount()函数返回Variant数组的维数，<br>
4.VarArrayLowBound()和VarArrayHighBound()函数分别返回Variant数组的下边界和上边界。<br>
5.VarArrayLock()和VarArrayUnlock()一般用于初始化一个大数组。<br>
如:<br>
它创建一个有10000字节的Variant数组。假定有另一个相同长度的非Variant类型的数组，并且想<br>
把非variant类型的数组复制到variant类型的数组中去。通常这都是通过用循环语句对variant数组<br>
的单元进行赋值实现的。示例如下：<br><br>
begin<br>
&nbsp;&nbsp;v:=VarArrayCreate([1,10000],varBate);<br>
&nbsp;&nbsp;fori:=1to10000do<br>
&nbsp;&nbsp;v[i]:=a[i];<br>
end;<br><br>
上面这段代码的主要问题在于，大量的时间花费在对Variant数组的初始化上，因为在对每一个元<br>
素进行赋值时，都要通过运行时逻辑来检查并判断数据类型的兼容性、每个元素的位置等等。为了避<br>
免运行时检查，要用VarArrayLock()函数和VarArrayUnlock()过程。VarArrayLock()函数在内存中锁<br>
定数组，使数组不再移动和改变大小，并能返回一个指向数组数据的指针。而VarArrayUnlock()过程<br>
用来对VarArrayLock()函数锁定的数组进行解锁，使数组能重新移动或改变大小。在锁定数组后，能<br>
用更有效的方法对数组进行初始化，例如用指向数组数据的指针调用Move()过程，下面的代码也对<br>
Variant数组进行初始化，但它更有效：<br><br>
begin<br>
&nbsp;&nbsp;v:=VarArrayCreate([1,10000],varBate);<br>
&nbsp;&nbsp;p:=VarArrayLock(v)<br>
&nbsp;&nbsp;try<br>
&nbsp;&nbsp; &nbsp;move(A,P^,10000);<br>
&nbsp;&nbsp;finally<br>
&nbsp;&nbsp; &nbsp;VarArrayUnlock(v);<br>
&nbsp;&nbsp;end;<br>
end;<br><br>
6.VarArrayRef()获得variant指向的数据<br>
7.VarIsArray()函数是一个简单的布尔检查函数，如果传递给它的参数是一个Variant数组则返回True，否则返回False.<br>
8.VarClear()过程清除Variant变量并将VType域的值设为varEmpty.<br>
9.VarCopy()将Source复制到Dest。<br>
10.VarCast()将一个Variant转换成指定的类型并存储在另一个Variant变量中。<br>
11.VarType()返回指定Variant的varXXX类型代码。<br>
12.VarAsType()跟VarCast()的功能一样。<br>
13.VarIsEmpty()如果一个Variant变量的类型代码是varEmpty则返回True。<br>
14.VarIsNull()判断Variant变量是否包含null值。<br>
15.VarToStr()将一个Variant变量转换成字符串表达式(如果Variant为varEmpty或varNUll则为空字符<br>
串)。<br>
16.VarFromDateTime()返回一个Variant变量，它存放着指定的TDateTime类型的值。<br>
17.VarToDateTime()返回在Variant中的TDateTime类型的值。</p>

<p>18.引用单元&nbsp;Variants</p>

<p>&nbsp;</p>

<h1><a name="t1"></a><a href="http://www.cnblogs.com/hnxxcxg/archive/2013/01/30/2882721.html" rel="nofollow" id="cb_post_title_url" data-token="247555ed9a9a16f9565f600093b247db">OleVariant的本质</a></h1>

<p>OleVariant的本质</p>

<p>OleVariant，COM的一种数据类型。MIDAS基于COM之上构建的，自然使用OleVariant作为数据序列格式。</p>

<p>延续到现在最新的DATASNAP仍然支持它。</p>

<p>TClientDataset.data，TClientDataset.delta，这俩个属性<br>
的类型都是OleVariant。</p>

<p>OleVariant可以是string,integer,float...<br>
这个大家都知道，但它也可以是array of OleVariant，这个<br>
可能有人不知道了。明白了这点就是datasnap中间件主从表<br>
数据同步的关键。</p>

<p>olevariant存在于windows和linux平台,这二种类型主要的不同是variant类型仅是当前的应用程序可以进行操作,而olevariant类型则是ole自动化服务器所以定义的统一的数据类型,意味着可以通过网络或其他程序进行操作,当然也不必担心其他客户端如何进行操作.</p>

<p>当你给一个variant类型的变量赋自定义的值的时候(例如delphi&nbsp;string,或一个其他的新的自定义类型),运行时间库将试着将他转化为olevariant标准数据类型(例如string转化为&nbsp;OLE&nbsp;BSTR&nbsp;string),例如,一个包括Ansistring数据的variant类型斌值给olevariant,ansiString将成为WideString,当把variant传为olevariant的函数参数也是一样的.</p>

<p>&nbsp;</p>

<p>------------------------------小小分割线---------------------------------</p>

<p>VarlsEmpty 与&nbsp;&nbsp;VarlsNull&nbsp;</p>

<p>他俩是一对双胞胎，长得像 但不是同一回事</p>

<p>都是用于判断 Variant /OleVariant 这些变体型的数据格式</p>

<p>区别（from delphi help）：</p>

<p>1、VarIsNull是确定Variant变量是不是包含一个NULL值，这个变量是有值的，不过只是NULL，比如数据库字段的 null字段</p>

<p>2、VarIsEmpty是确定Variant变量是不是有值，没有赋过值，这时这个函数返回True<br>
&nbsp;———————————</p>
                                    </div>
                    </div>
    </article>

</div></body>

</html>
