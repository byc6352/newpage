<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
  <link rel="stylesheet" href="images/style.css" />
</head>

<body class="stackedit">

<div id="article_content" class="article_content clearfix">
                                    <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
                                        <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
                <div class="htmledit_views" id="content_views">
                                            
<ul><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1</span><span style="color:rgb(0,0,255);">.</span>GoHome;&nbsp;<span style="color:rgb(0,130,0);">//到浏览器默认主页</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>Refresh;&nbsp;</span><span style="color:rgb(0,130,0);">//刷新</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>GoBack;&nbsp;</span><span style="color:rgb(0,130,0);">//后退</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>GoForward;&nbsp;</span><span style="color:rgb(0,130,0);">//前进</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>Navigate(</span><span style="color:rgb(0,0,255);">'...'</span>);&nbsp;<span style="color:rgb(0,130,0);">//打开指定页面</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>Navigate(</span><span style="color:rgb(0,0,255);">'about:blank'</span>);&nbsp;<span style="color:rgb(0,130,0);">//打开空页面</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//打开空页面,&nbsp;并写入...</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;">&nbsp;&nbsp;</li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>Navigate(</span><span style="color:rgb(0,0,255);">'about:&lt;head&gt;&lt;title&gt;标题&lt;/title&gt;&lt;body&gt;页面内容&lt;/body&gt;'</span>);&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//读取网页脚本中的变量:</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>Button1Click(Sender:&nbsp;TObject);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">var</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">s:&nbsp;<span style="color:rgb(0,102,153);">string</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">i:&nbsp;Integer;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">s&nbsp;:=&nbsp;WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>Script<span style="color:rgb(0,0,255);">.</span>str;&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">i&nbsp;:=&nbsp;WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>Script<span style="color:rgb(0,0,255);">.</span>num;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ShowMessage(s);&nbsp;<span style="color:rgb(0,130,0);">//Hello</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ShowMessage(IntToStr(i));&nbsp;<span style="color:rgb(0,130,0);">//99</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//也可以这样读:</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">s&nbsp;:=&nbsp;WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>parentWindow<span style="color:rgb(0,0,255);">.</span>str;&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">i&nbsp;:=&nbsp;WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>parentWindow<span style="color:rgb(0,0,255);">.</span>num;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ShowMessage(s);&nbsp;<span style="color:rgb(0,130,0);">//Hello</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ShowMessage(IntToStr(i));&nbsp;<span style="color:rgb(0,130,0);">//99</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&amp;amp;lt;br&amp;amp;gt;假如网页中有这样的语句:&amp;amp;lt;br&amp;amp;gt;&amp;amp;amp;amp;lt;script&amp;amp;amp;amp;gt;&amp;amp;lt;br&amp;amp;gt;<span style="color:rgb(0,102,153);">var</span>&amp;amp;lt;br&amp;amp;gt;&nbsp;str&nbsp;=&nbsp;&amp;amp;quot;Hello&amp;amp;quot;;&amp;amp;lt;br&amp;amp;gt;&nbsp;i&nbsp;=&nbsp;</span><span style="color:rgb(0,0,255);">99</span>;&amp;amp;lt;br&amp;amp;gt;&amp;amp;amp;amp;lt;/script&amp;amp;amp;amp;gt;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//调用网页脚本中的函数:</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>Button1Click(Sender:&nbsp;TObject);&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>parentWindow<span style="color:rgb(0,0,255);">.</span>MB();&nbsp;<span style="color:rgb(0,130,0);">//HTML-Js</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//如需指定脚本语言,&nbsp;需要:</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>parentWindow<span style="color:rgb(0,0,255);">.</span>execScript(<span style="color:rgb(0,0,255);">'MB()'</span>,<span style="color:rgb(0,0,255);">'JavaScript'</span>);&nbsp;<span style="color:rgb(0,130,0);">//HTML-Js</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&amp;amp;lt;br&amp;amp;gt;假如有这样的脚本:&amp;amp;lt;br&amp;amp;gt;&amp;amp;amp;amp;lt;script&amp;amp;amp;amp;gt;&amp;amp;lt;br&amp;amp;gt;<span style="color:rgb(0,102,153);">function</span>&nbsp;MB()</span><span style="color:rgb(0,130,0);">{&nbsp;&amp;amp;lt;br&amp;amp;gt;&nbsp;alert('HTML-Js');&amp;amp;lt;br&amp;amp;gt;}</span>&amp;amp;lt;br&amp;amp;gt;&amp;amp;amp;amp;lt;/script&amp;amp;amp;amp;gt;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//判断网页及内部框架网页是否全部下载完毕</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>WebBrowser1DocumentComplete(ASender:&nbsp;TObject;&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">const</span>&nbsp;pDisp:&nbsp;IDispatch;&nbsp;</span><span style="color:rgb(0,102,153);">var</span>&nbsp;URL:&nbsp;OleVariant);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">if</span>&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,102,153);">not</span>(&lt;span&nbsp;style="font-family:&nbsp;Arial,&nbsp;Helvetica,&nbsp;sans-serif;"&gt;WebBrowser1&lt;/span&gt;.Busy)&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;ShowMessage(<span style="color:rgb(0,0,255);">'下载完毕'</span>);&nbsp;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//改变背景色或背景图片:</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>body<span style="color:rgb(0,0,255);">.</span>bgcolor&nbsp;:=&nbsp;<span style="color:rgb(0,0,255);">'#FF0000'</span>;&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>body<span style="color:rgb(0,0,255);">.</span>background&nbsp;:=&nbsp;<span style="color:rgb(0,0,255);">'...图片地址'</span>;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//操作有&nbsp;ID&nbsp;标签的对象:</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">var</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">s:&nbsp;<span style="color:rgb(0,102,153);">string</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">s&nbsp;:=&nbsp;WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>getElementByIdx_x(<span style="color:rgb(0,0,255);">'span1'</span>).innerText;&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ShowMessage(s);&nbsp;<span style="color:rgb(0,130,0);">//这是&nbsp;span1&nbsp;标签中的内容</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//或者:</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">s&nbsp;:=&nbsp;WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>parentWindow<span style="color:rgb(0,0,255);">.</span>span1<span style="color:rgb(0,0,255);">.</span>innerText;&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ShowMessage(s);&nbsp;<span style="color:rgb(0,130,0);">//这是&nbsp;span1&nbsp;标签中的内容</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//隐藏它:</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>parentWindow<span style="color:rgb(0,0,255);">.</span>span1<span style="color:rgb(0,0,255);">.</span>style<span style="color:rgb(0,0,255);">.</span>display&nbsp;:=&nbsp;<span style="color:rgb(0,0,255);">'none'</span>;&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&amp;amp;lt;br&amp;amp;gt;假如网页中有这样的内容:&amp;amp;lt;br&amp;amp;gt;&amp;amp;amp;amp;lt;span&nbsp;id=span1&amp;amp;amp;amp;gt;这是&nbsp;span1&nbsp;标签中的内容&amp;amp;amp;amp;lt;/span&amp;amp;amp;amp;gt;&amp;amp;lt;br&amp;amp;gt;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//获取网页源代码</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">var</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">s:&nbsp;<span style="color:rgb(0,102,153);">string</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">s&nbsp;:=&nbsp;WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>body<span style="color:rgb(0,0,255);">.</span>innerHTML;&nbsp;<span style="color:rgb(0,130,0);">//body内的所有代码</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">s&nbsp;:=&nbsp;WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>body<span style="color:rgb(0,0,255);">.</span>outerHTML;&nbsp;<span style="color:rgb(0,130,0);">//body内的所有代码,&nbsp;包含body标签</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">s&nbsp;:=&nbsp;WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>document<span style="color:rgb(0,0,255);">.</span>documentElement<span style="color:rgb(0,0,255);">.</span>innerHTML;&nbsp;<span style="color:rgb(0,130,0);">//html内的所有代码</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span style="color:rgb(0,102,153);">class</span>="delphi"&gt;&lt;span&nbsp;style="color:&nbsp;rgb(</span><span style="color:rgb(0,0,255);">73</span>,&nbsp;<span style="color:rgb(0,0,255);">73</span>,&nbsp;<span style="color:rgb(0,0,255);">73</span>);&nbsp;font-family:&nbsp;simsun;&nbsp;font-size:&nbsp;14px;&nbsp;line-height:&nbsp;21px;"&gt;Memo1<span style="color:rgb(0,0,255);">.</span>Lines<span style="color:rgb(0,0,255);">.</span>Add(IHtmlDocument2(WebBrowser1<span style="color:rgb(0,0,255);">.</span>Document).Body<span style="color:rgb(0,0,255);">.</span>OuterHtml);&lt;/span&gt;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//获取网页全部源代码</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">uses</span>&nbsp;ActiveX;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">var</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ms:&nbsp;TMemoryStream;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">if</span>&nbsp;</span><span style="color:rgb(0,102,153);">not</span>&nbsp;Assigned(WebBrowser1<span style="color:rgb(0,0,255);">.</span>Document)&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;Exit;&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ms&nbsp;:=&nbsp;TMemoryStream<span style="color:rgb(0,0,255);">.</span>Create;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">(WebBrowser1<span style="color:rgb(0,0,255);">.</span>Document&nbsp;</span><span style="color:rgb(0,102,153);">as</span>&nbsp;IPersistStreamInit).Save(TStreamAdapter<span style="color:rgb(0,0,255);">.</span>Create(ms),&nbsp;True);&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">ms<span style="color:rgb(0,0,255);">.</span>Position&nbsp;:=&nbsp;</span><span style="color:rgb(0,0,255);">0</span>;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">Memo1<span style="color:rgb(0,0,255);">.</span>Lines</span><span style="color:rgb(0,0,255);">.</span>LoadFromStream(ms,&nbsp;TEncoding<span style="color:rgb(0,0,255);">.</span>UTF8);&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//&nbsp;Memo1.Lines.LoadFromStream(ms,&nbsp;TEncoding.Default);&nbsp;{GB2312&nbsp;等双字节}</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ms<span style="color:rgb(0,0,255);">.</span>Free;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//WebBrowser&nbsp;中的右键菜单</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//先要添加ApplicationEvents1,指定其Message事件</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//屏蔽右键菜单</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>ApplicationEvents1Message(<span style="color:rgb(0,102,153);">var</span>&nbsp;Msg:&nbsp;tagMSG;&nbsp;<span style="color:rgb(0,102,153);">var</span>&nbsp;Handled:&nbsp;Boolean);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">with</span>&nbsp;Msg&nbsp;</span><span style="color:rgb(0,102,153);">do</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">if</span>&nbsp;</span><span style="color:rgb(0,102,153);">not</span>&nbsp;IsChild(WebBrowser1<span style="color:rgb(0,0,255);">.</span>Handle,&nbsp;hWnd)&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;Exit;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">Handled&nbsp;:=&nbsp;(message&nbsp;=&nbsp;WM_RBUTTONDOWN)&nbsp;<span style="color:rgb(0,102,153);">or</span>&nbsp;(message&nbsp;=&nbsp;WM_RBUTTONUP)&nbsp;</span><span style="color:rgb(0,102,153);">or</span>&nbsp;(message&nbsp;=&nbsp;WM_CONTEXTMENU);&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//替换右键菜单</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>ApplicationEvents1Message(<span style="color:rgb(0,102,153);">var</span>&nbsp;Msg:&nbsp;tagMSG;&nbsp;<span style="color:rgb(0,102,153);">var</span>&nbsp;Handled:&nbsp;Boolean);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">var</span>&nbsp;mPoint:&nbsp;TPoint;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">if</span>&nbsp;IsChild(WebBrowser1</span><span style="color:rgb(0,0,255);">.</span>Handle,&nbsp;Msg<span style="color:rgb(0,0,255);">.</span>Hwnd)&nbsp;<span style="color:rgb(0,102,153);">and</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">((Msg<span style="color:rgb(0,0,255);">.</span>Message&nbsp;=&nbsp;WM_RBUTTONDOWN)&nbsp;</span><span style="color:rgb(0,102,153);">or</span>&nbsp;(Msg<span style="color:rgb(0,0,255);">.</span>Message&nbsp;=&nbsp;WM_RBUTTONUP))&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">GetCursorPos(mPoint);&nbsp;<span style="color:rgb(0,130,0);">//得到光标位置</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">PopupMenu1<span style="color:rgb(0,0,255);">.</span>Popup(mPoint</span><span style="color:rgb(0,0,255);">.</span>X,&nbsp;mPoint<span style="color:rgb(0,0,255);">.</span>Y);&nbsp;<span style="color:rgb(0,130,0);">//弹出popupmenu1的菜单</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">Handled:=True;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//新页面写入</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>Navigate(</span><span style="color:rgb(0,0,255);">'about:blank'</span>);&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>OleObject</span><span style="color:rgb(0,0,255);">.</span>Document<span style="color:rgb(0,0,255);">.</span>Writeln(<span style="color:rgb(0,0,255);">'ok'</span>);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//从流中写入:</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">var</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ms:&nbsp;TMemoryStream;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ms&nbsp;:=&nbsp;TMemoryStream<span style="color:rgb(0,0,255);">.</span>Create;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">Memo1<span style="color:rgb(0,0,255);">.</span>Lines</span><span style="color:rgb(0,0,255);">.</span>SaveToStream(ms);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">ms<span style="color:rgb(0,0,255);">.</span>Position&nbsp;:=&nbsp;</span><span style="color:rgb(0,0,255);">0</span>;&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">(WebBrowser1<span style="color:rgb(0,0,255);">.</span>Document&nbsp;</span><span style="color:rgb(0,102,153);">as</span>&nbsp;IPersistStreamInit).Load(TStreamAdapter<span style="color:rgb(0,0,255);">.</span>Create(ms));&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">ms<span style="color:rgb(0,0,255);">.</span>Free;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//禁止提示脚步错误</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>WebBrowser1NavigateComplete2(ASender:&nbsp;TObject;&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">const</span>&nbsp;pDisp:&nbsp;IDispatch;&nbsp;</span><span style="color:rgb(0,102,153);">var</span>&nbsp;URL:&nbsp;OleVariant);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">WebBrowser1<span style="color:rgb(0,0,255);">.</span>Silent&nbsp;:=&nbsp;True;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span style="color:rgb(0,102,153);">class</span>="delphi"&gt;方法二&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">TWebBrowser的OnDownloadComplete事件里面执行&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">(WebBrowser1<span style="color:rgb(0,0,255);">.</span>Document&nbsp;</span><span style="color:rgb(0,102,153);">as</span>&nbsp;IHTMLDocument2).parentWindow<span style="color:rgb(0,0,255);">.</span>execScript(<span style="color:rgb(0,0,255);">'window.οnerrοr=function(){return&nbsp;true}'</span>,<span style="color:rgb(0,0,255);">'JavaScript'</span>);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span style="color:rgb(0,102,153);">class</span>="delphi"&gt;</span><span style="color:rgb(0,130,0);">//禁止弹出窗口</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>WebBrowser1NewWindow2(ASender:&nbsp;TObject;&nbsp;<span style="color:rgb(0,102,153);">var</span>&nbsp;ppDisp:&nbsp;IDispatch;&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">var</span>&nbsp;Cancel:&nbsp;WordBool);&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">Cancel&nbsp;:=&nbsp;True;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span style="color:rgb(0,102,153);">class</span>="delphi"&gt;</span><span style="color:rgb(0,130,0);">//使WebBrowser获得焦点</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　TWebBrowser非常特殊，它从TWinControl继承来的SetFocus方法并不能使得它所twebbrows&nbsp;setfocu&nbsp;方法包含的文档获得焦点，从而不能立即使用Internet&nbsp;Explorer本身具有得internet&nbsp;explor&nbsp;使用快捷键，解决方法如下：&lt;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　<span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>SetFocusToDoc;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　<span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　<span style="color:rgb(0,102,153);">if</span>&nbsp;WebBrowser1</span><span style="color:rgb(0,0,255);">.</span>Document&nbsp;&lt;&gt;&nbsp;<span style="color:rgb(0,102,153);">nil</span>&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　<span style="color:rgb(0,102,153);">with</span>&nbsp;WebBrowser1</span><span style="color:rgb(0,0,255);">.</span>Application&nbsp;<span style="color:rgb(0,102,153);">as</span>&nbsp;Ioleobject&nbsp;<span style="color:rgb(0,102,153);">do</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　　DoVerb(OLEIVERB_UIACTIVATE,&nbsp;<span style="color:rgb(0,102,153);">nil</span>,&nbsp;WebBrowser1,&nbsp;</span><span style="color:rgb(0,0,255);">0</span>,&nbsp;Handle,&nbsp;GetClientRect);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　<span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　除此之外，我还找到一种更简单的方法，这里一并列除此之外这里并列出：&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　<span style="color:rgb(0,102,153);">if</span>&nbsp;WebBrowser1</span><span style="color:rgb(0,0,255);">.</span>Document&nbsp;&lt;&gt;&nbsp;<span style="color:rgb(0,102,153);">nil</span>&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　IHTMLWindow2(IHTMLDocument2(WebBrowser1<span style="color:rgb(0,0,255);">.</span>Document).ParentWindow).focus&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　刚找到了更简单的方法，也许是最简单的：&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　<span style="color:rgb(0,102,153);">if</span>&nbsp;WebBrowser1</span><span style="color:rgb(0,0,255);">.</span>Document&nbsp;&lt;&gt;&nbsp;<span style="color:rgb(0,102,153);">nil</span>&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　IHTMLWindow4(WebBrowser1<span style="color:rgb(0,0,255);">.</span>Document).focus&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　还有，需要判断文档是否获得焦点这样来做：&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　<span style="color:rgb(0,102,153);">if</span>&nbsp;IHTMLWindow4(WebBrowser1</span><span style="color:rgb(0,0,255);">.</span>Document).hasfocus&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span style="color:rgb(0,102,153);">class</span>="delphi"&gt;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,0);">//查找内容</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　查找对话框可以在文档获得焦点的时候通过按键Ctrl-F对话框焦点按键来调出，程序中则调用IOleCommandTarget对象的成员函数Exec执行OLECMDID_FIND操作olecmdid&nbsp;操作执行来调用，下面给出的方法是如何在程序中用代码来做出文下面方法如何字选择，即你可以自己设计查找对话框。&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　Var&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　Doc:&nbsp;IHtmlDocument2;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　TxtRange:&nbsp;IHtmlTxtRange;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　<span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　Doc&nbsp;:=WebBrowser1<span style="color:rgb(0,0,255);">.</span>Document&nbsp;</span><span style="color:rgb(0,102,153);">as</span>&nbsp;IHtmlDocument2;&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　Doc<span style="color:rgb(0,0,255);">.</span>SelectAll;　　　　</span><span style="color:rgb(0,130,0);">//此处为简写，选择全部文档的方法selectal&nbsp;方法文档请参见第三条命令操作</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　　　　　　　　　　<span style="color:rgb(0,130,0);">//这句话尤为重要，因重要尤为为IHtmlTxtRange对象的方法能够操作的前提是</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　　　　　　　　　　<span style="color:rgb(0,130,0);">//Document已经有一个文字选document&nbsp;文字一个择区域。由于接着执行下面的语句，所以不会</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　　　　　　　　　　<span style="color:rgb(0,130,0);">//看到文档全选的过程看到过程文档。</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　TxtRange&nbsp;:=Doc<span style="color:rgb(0,0,255);">.</span>Selection</span><span style="color:rgb(0,0,255);">.</span>CreateRange&nbsp;<span style="color:rgb(0,102,153);">as</span>&nbsp;IHtmlTxtRange;&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　TxtRange<span style="color:rgb(0,0,255);">.</span>FindText(</span><span style="color:rgb(0,0,255);">'Text&nbsp;to&nbsp;be&nbsp;searched'</span>,<span style="color:rgb(0,0,255);">0.0</span>);&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　TxtRange<span style="color:rgb(0,0,255);">.</span>Select;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　<span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　还有，从Txt<span style="color:rgb(0,0,255);">.</span>Get_text可以得到当前选中的文字内容，某些得到文字当前时候是有用的。&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span style="color:rgb(0,102,153);">class</span>="delphi"&gt;</span><span style="color:rgb(0,130,0);">//点击“提交”按钮</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　如同程序里每个窗体上有一个“缺省”按钮一样，Web一样按钮每个页面上的每个Form也有一个“缺省”按钮——即属性为“Submitsubmit&nbsp;form&nbsp;按钮”的按钮，当用户按下回车键时就相当于鼠标单击了“Submitsubmit&nbsp;回车键相当”。但是TWebBrowser似乎并不响应回车键，并且，即使把包含TWebBrowser的twebbrows&nbsp;回车键似乎窗体的KeyPreview设为True，在窗体的KeyPress事件里还是不能截获用户向keypreview&nbsp;keypress&nbsp;事件TWebBrowser发出的按键。&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　我的解决办法是用ApplicatinEvents构件或者自己编写Tapplication对象的OnMessage事onmessag&nbsp;tapplic&nbsp;构件件，在其中判断消息类型，对键盘消息做出响应。至于点至于响应判断击“提交”按钮，可以通过分析网页源代码的方法来实现源代码网页方法，不过我找到了更为简单快捷的方法，有两种，第一种是更为不过方法我自己想出来的，另一种是别人写的代码，这里都提供给自己这里出来大家，以做参考。&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　A、用SendKeys函数向WebBrowser发送回车键&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　&nbsp;在Delphi5光盘上的Info/Extras/SendKeys目录下有一个SndKey32<span style="color:rgb(0,0,255);">.</span>pas文件，sendkei&nbsp;delphi&nbsp;sndkei其中包含了两个函数SendKeys和AppActivate，我们可以用SendKeys函数来向WebBrowser发appactiv&nbsp;webbrows&nbsp;sendkei送回车键，我现在用的就是这个方法，使用很简单，在WebBrowserwebbrows&nbsp;回车键使用获得焦点的情况下（不要求WebBrowser所包含的文档获得焦点），webbrows&nbsp;焦点包含用一条语句即可：&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　Sendkeys(<span style="color:rgb(0,0,255);">'~'</span>,</span><span style="color:rgb(0,102,153);">true</span>);<span style="color:rgb(0,130,0);">//&nbsp;press&nbsp;RETURN&nbsp;key</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　SendKeys函数的详细参数说明等，均包含在SndKey32<span style="color:rgb(0,0,255);">.</span>pas文件中sendkei&nbsp;sndkei&nbsp;参数。&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　B、在OnMessage事件中将接受到的键盘消息传递给WebBrowser。&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　Procedure&nbsp;TForm1<span style="color:rgb(0,0,255);">.</span>ApplicationEvents1Message(</span><span style="color:rgb(0,102,153);">var</span>&nbsp;Msg:&nbsp;TMsg;&nbsp;<span style="color:rgb(0,102,153);">var</span>&nbsp;Handled:&nbsp;Boolean);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　<span style="color:rgb(0,130,0);">{fixes&nbsp;the&nbsp;malfunction&nbsp;of&nbsp;some&nbsp;keys&nbsp;within&nbsp;webbrowser&nbsp;control}</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　<span style="color:rgb(0,102,153);">const</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　StdKeys&nbsp;=&nbsp;[VK_TAB,&nbsp;VK_RETURN];&nbsp;<span style="color:rgb(0,130,0);">{&nbsp;standard&nbsp;keys&nbsp;}</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　ExtKeys&nbsp;=&nbsp;[VK_DELETE,&nbsp;VK_BACK,&nbsp;VK_LEFT,&nbsp;VK_RIGHT];&nbsp;<span style="color:rgb(0,130,0);">{&nbsp;extended&nbsp;keys&nbsp;}</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　fExtended&nbsp;=&nbsp;<span style="color:rgb(0,0,255);">$01000000</span>;&nbsp;</span><span style="color:rgb(0,130,0);">{&nbsp;extended&nbsp;key&nbsp;flag&nbsp;}</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　<span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　Handled&nbsp;:=&nbsp;False;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　<span style="color:rgb(0,102,153);">with</span>&nbsp;Msg&nbsp;</span><span style="color:rgb(0,102,153);">do</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　<span style="color:rgb(0,102,153);">if</span>&nbsp;((Message&nbsp;&gt;=&nbsp;WM_KEYFIRST)&nbsp;</span><span style="color:rgb(0,102,153);">and</span>&nbsp;(Message&nbsp;&lt;=&nbsp;WM_KEYLAST))&nbsp;<span style="color:rgb(0,102,153);">and</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　　((wParam&nbsp;<span style="color:rgb(0,102,153);">in</span>&nbsp;StdKeys)&nbsp;</span><span style="color:rgb(0,102,153);">or</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　<span style="color:rgb(0,130,132);">{$IFDEF&nbsp;VER120}(GetKeyState(VK_CONTROL)&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;{$ENDIF}</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　　(wParam&nbsp;<span style="color:rgb(0,102,153);">in</span>&nbsp;ExtKeys)&nbsp;</span><span style="color:rgb(0,102,153);">and</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　　((lParam&nbsp;<span style="color:rgb(0,102,153);">and</span>&nbsp;fExtended)&nbsp;=&nbsp;fExtended))&nbsp;</span><span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　<span style="color:rgb(0,102,153);">try</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　　<span style="color:rgb(0,102,153);">if</span>&nbsp;IsChild(Handle,&nbsp;hWnd)&nbsp;</span><span style="color:rgb(0,102,153);">then</span>&nbsp;<span style="color:rgb(0,130,0);">{&nbsp;handles&nbsp;all&nbsp;browser&nbsp;related&nbsp;messages&nbsp;}</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　<span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　　　<span style="color:rgb(0,102,153);">with</span>&nbsp;</span><span style="color:rgb(0,130,132);">{$IFDEF&nbsp;VER120}Application_{$ELSE}Application{$ENDIF}</span>&nbsp;<span style="color:rgb(0,102,153);">as</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　　IOleInPlaceActiveObject&nbsp;<span style="color:rgb(0,102,153);">do</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　Handled&nbsp;:=&nbsp;TranslateAccelerator(Msg)&nbsp;=&nbsp;S_OK;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　　　　<span style="color:rgb(0,102,153);">if</span>&nbsp;</span><span style="color:rgb(0,102,153);">not</span>&nbsp;Handled&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　<span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　　Handled&nbsp;:=&nbsp;True;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　　TranslateMessage(Msg);&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　　DispatchMessage(Msg);&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　<span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　　　　<span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　<span style="color:rgb(0,102,153);">except</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　　<span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　<span style="color:rgb(0,102,153);">end</span>;&nbsp;</span><span style="color:rgb(0,130,0);">//&nbsp;MessageHandler</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span style="color:rgb(0,102,153);">class</span>="delphi"&gt;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span style="color:rgb(0,102,153);">class</span>="delphi"&gt;</span><span style="color:rgb(0,0,255);">10</span>、提取网页中所有链接&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　这个方法来自大富翁论坛hopfield朋友的对一个问题的回答hopfield&nbsp;自大问题，我本想自己试验，但总是没成功。&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　Var&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　doc:IHTMLDocument2;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　all:IHTMLElementCollection;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　len,I:<span style="color:rgb(0,102,153);">integer</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　item:OleVariant;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　<span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　doc:=WebBrowser1&nbsp;.Document&nbsp;<span style="color:rgb(0,102,153);">as</span>&nbsp;IHTMLDocument2;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　all:=doc<span style="color:rgb(0,0,255);">.</span>Get_links;　　　　　　　　　　　　　</span><span style="color:rgb(0,130,0);">//doc.Links亦可</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　len:=all<span style="color:rgb(0,0,255);">.</span>length;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　<span style="color:rgb(0,102,153);">for</span>&nbsp;I:=</span><span style="color:rgb(0,0,255);">0</span>&nbsp;<span style="color:rgb(0,102,153);">to</span>&nbsp;len-<span style="color:rgb(0,0,255);">1</span>&nbsp;<span style="color:rgb(0,102,153);">do</span>&nbsp;<span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　item:=all<span style="color:rgb(0,0,255);">.</span>item(I,varempty);　　　　　　　　</span><span style="color:rgb(0,130,0);">//EmpryParam亦可</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　　memo1<span style="color:rgb(0,0,255);">.</span>lines</span><span style="color:rgb(0,0,255);">.</span>add(item<span style="color:rgb(0,0,255);">.</span>href);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　<span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　<span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">-----------------------------------------------------------------------------------&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,0,255);">11</span>、设置TWebBrowser的编码&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　为什么我总是错过很多机会？其实早就该想到的，但为什么错过想到是一念之差，便即天壤之别。当时我要是肯再多考虑一下一念之差天壤之别当时，多试验一下，这就不会排到第１１条了。下面给出一个下面试验一个函数，搞定，难以想象的简单。&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　Procedure&nbsp;SetCharSet(AWebBrowser:&nbsp;TWebBrowser;&nbsp;ACharSet:&nbsp;String);&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　<span style="color:rgb(0,102,153);">var</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　RefreshLevel:&nbsp;OleVariant;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　Begin&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　IHTMLDocument2(AWebBrowser<span style="color:rgb(0,0,255);">.</span>Document).Set_CharSet(ACharSet);&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">　　　RefreshLevel&nbsp;:=<span style="color:rgb(0,0,255);">7</span>;　　　　　　　　　　　　　　</span><span style="color:rgb(0,130,0);">//这个7应该从这个应该注册表来，帮助有Bug。</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　　AWebBrowser<span style="color:rgb(0,0,255);">.</span>Refresh2(RefreshLevel);&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">　　End;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span style="color:rgb(0,102,153);">class</span>="delphi"&gt;</span><span style="color:rgb(0,0,255);">9</span>．将页面中显示的内容全部选中,然后粘贴到Word文档中.&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>ExecWB(OLECMDID_SELECTALL,&nbsp;OLECMDEXECOPT_DODEFAULT);</span><span style="color:rgb(0,130,0);">//全选网页</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>ExecWB(OLECMDID_COPY,&nbsp;OLECMDEXECOPT_DODEFAULT);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,130,0);">//复制网页</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WordDocu<span style="color:rgb(0,0,255);">.</span>Range</span><span style="color:rgb(0,0,255);">.</span>Paste;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,130,0);">//word文档粘贴</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">WebBrowser1<span style="color:rgb(0,0,255);">.</span>ExecWB(OLECMDID_UNDO,&nbsp;OLECMDEXECOPT_DODEFAULT);&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,130,0);">//取消全选</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">注:WebBrowser的Document属性值和WordDocument的Document属性值必须都不为<span style="color:rgb(0,102,153);">nil</span>.&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,0,255);">10</span>．如何解决网页不响应回车事件&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">public</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,130,0);">{&nbsp;Public&nbsp;declarations&nbsp;}</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,102,153);">procedure</span>&nbsp;MsgHandle(</span><span style="color:rgb(0,102,153);">var</span>&nbsp;Msg&nbsp;:TMsg;&nbsp;<span style="color:rgb(0,102,153);">var</span>&nbsp;Handled&nbsp;:Boolean);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">var</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">Form1:&nbsp;TForm1;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">FOleInPlaceActiveObject&nbsp;:IOleInPlaceActiveObject;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">implementation</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,130,132);">{$R&nbsp;*.DFM}</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>MsgHandle(<span style="color:rgb(0,102,153);">var</span>&nbsp;Msg&nbsp;:TMsg;&nbsp;<span style="color:rgb(0,102,153);">var</span>&nbsp;Handled&nbsp;:Boolean);&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">var</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">iOIPAO&nbsp;:IOleInPlaceActiveObject;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">Dispatch&nbsp;:IDispatch;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">if</span>&nbsp;WebBrowser1&nbsp;=</span><span style="color:rgb(0,102,153);">nil</span>&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">Handled&nbsp;:=False;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">Exit;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">Handled&nbsp;:=(IsDialogMessage(WebBrowser1<span style="color:rgb(0,0,255);">.</span>Handle,&nbsp;Msg)&nbsp;=True);&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">if</span>&nbsp;(Handled)&nbsp;</span><span style="color:rgb(0,102,153);">and</span>&nbsp;(<span style="color:rgb(0,102,153);">not</span>&nbsp;WebBrowser1<span style="color:rgb(0,0,255);">.</span>Busy)&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">if</span>&nbsp;FOleInPlaceActiveObject&nbsp;=</span><span style="color:rgb(0,102,153);">nil</span>&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;&nbsp;Dispatch&nbsp;:=WebBrowser1<span style="color:rgb(0,0,255);">.</span>Application;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,102,153);">if</span>&nbsp;Dispatch&nbsp;&lt;&gt;</span><span style="color:rgb(0,102,153);">nil</span>&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;&nbsp;&nbsp;Dispatch<span style="color:rgb(0,0,255);">.</span>QueryInterface(IOleInPlaceActiveObject,&nbsp;iOIPAO);&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,102,153);">if</span>&nbsp;iOIPAO&nbsp;&lt;&gt;</span><span style="color:rgb(0,102,153);">nil</span>&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOleInPlaceActiveObject&nbsp;:=iOIPAO;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">if</span>&nbsp;FOleInPlaceActiveObject&nbsp;&lt;&gt;</span><span style="color:rgb(0,102,153);">nil</span>&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">if</span>&nbsp;((Msg</span><span style="color:rgb(0,0,255);">.</span>message&nbsp;=WM_KEYDOWN)&nbsp;<span style="color:rgb(0,102,153);">or</span>&nbsp;(Msg<span style="color:rgb(0,0,255);">.</span>Message&nbsp;=WM_KEYUP))&nbsp;<span style="color:rgb(0,102,153);">and</span>&nbsp;((Msg<span style="color:rgb(0,0,255);">.</span>wParam&nbsp;=VK_BACK)&nbsp;<span style="color:rgb(0,102,153);">or</span>&nbsp;(Msg<span style="color:rgb(0,0,255);">.</span>wParam&nbsp;=VK_LEFT)&nbsp;<span style="color:rgb(0,102,153);">or</span>&nbsp;(Msg<span style="color:rgb(0,0,255);">.</span>wParam&nbsp;=VK_RIGHT))&nbsp;<span style="color:rgb(0,102,153);">then</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">else</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;&nbsp;FOleInPlaceActiveObject<span style="color:rgb(0,0,255);">.</span>TranslateAccelerator(Msg);&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>FormCreate(Sender:&nbsp;TObject);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">Application<span style="color:rgb(0,0,255);">.</span>OnMessage&nbsp;:=MsgHandle;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>FormDestroy(Sender:&nbsp;TObject);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">FOleInPlaceActiveObject&nbsp;:=<span style="color:rgb(0,102,153);">nil</span>;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">&lt;/pre&gt;&lt;pre&nbsp;name="code"&nbsp;<span style="color:rgb(0,102,153);">class</span>="delphi"&gt;</span><span style="color:rgb(0,130,0);">//在WebBrowser加载html页面完成后,在页面顶端插入HTML代码</span>&nbsp;&nbsp;</span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);"><span style="color:rgb(0,102,153);">procedure</span>&nbsp;TForm1</span><span style="color:rgb(0,0,255);">.</span>Button1Click(Sender:&nbsp;TObject);&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">var</span>&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">Range:&nbsp;IHTMLTxtRange;&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">begin</span>&nbsp;&nbsp;</span></span></li><li><span style="font-size:12px;"><span style="color:rgb(0,0,0);">Range&nbsp;:=&nbsp;((WebBrowser1<span style="color:rgb(0,0,255);">.</span>Document&nbsp;</span><span style="color:rgb(0,102,153);">as</span>&nbsp;IHTMLDocument2).body&nbsp;<span style="color:rgb(0,102,153);">as</span>&nbsp;&nbsp;</span></li><li style="color:inherit;"><span style="color:rgb(0,0,0);"><span style="font-size:12px;">&nbsp;&nbsp;&nbsp;&nbsp;IHTMLBodyElement).createTextRange;&nbsp;&nbsp;</span></span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;">Range<span style="color:rgb(0,0,255);">.</span>collapse(False);&nbsp;&nbsp;</span></span></li><li style="color:inherit;"><span style="font-size:12px;"><span style="color:rgb(0,0,0);">Range<span style="color:rgb(0,0,255);">.</span>pasteHTML(</span><span style="color:rgb(0,0,255);">'&lt;br/&gt;&lt;b&gt;Hello!&lt;/b&gt;'</span>);&nbsp;&nbsp;</span></li><li><span style="color:rgb(0,0,0);"><span style="font-size:12px;"><span style="color:rgb(0,102,153);">end</span>;&nbsp;</span></span></li></ul>                                    </div>
                    </div>
</body>

</html>
